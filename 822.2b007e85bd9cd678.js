"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[822],{2822:(q,b,r)=>{r.r(b),r.d(b,{default:()=>Y});var t=r(9212),g=r(6223),T=r(2296),M=r(5986),x=r(3680),I=r(4170),C=r(617),D=r(4516),Z=r(1476),R=r(6007),y=r(8525),S=r(2599),P=r(3566),$=r(4748),A=r(5313),w=r(8645),l=r(9773),U=r(3620),n=r(4664),d=r(7398),V=r(3019),E=r(6278),p=r(5619),v=r(9397),u=r(8180),L=r(8504),k=r(2096),F=r(2181),B=r(1474);let m=(()=>{class h{constructor(e){this._httpClient=e,this._brands=new p.X(null),this._categories=new p.X(null),this._pagination=new p.X(null),this._product=new p.X(null),this._products=new p.X(null),this._tags=new p.X(null),this._vendors=new p.X(null)}get brands$(){return this._brands.asObservable()}get categories$(){return this._categories.asObservable()}get pagination$(){return this._pagination.asObservable()}get product$(){return this._product.asObservable()}get products$(){return this._products.asObservable()}get tags$(){return this._tags.asObservable()}get vendors$(){return this._vendors.asObservable()}getBrands(){return this._httpClient.get("api/apps/tesoreria/Motivos/brands").pipe((0,v.b)(e=>{this._brands.next(e)}))}getCategories(){return this._httpClient.get("api/apps/tesoreria/Motivos/categories").pipe((0,v.b)(e=>{this._categories.next(e)}))}getProducts(e=0,s=10,i="name",o="asc",a=""){return this._httpClient.get("api/apps/tesoreria/Motivos/products",{params:{page:""+e,size:""+s,sort:i,order:o,search:a}}).pipe((0,v.b)(c=>{this._pagination.next(c.pagination),this._products.next(c.products)}))}getProductById(e){return this._products.pipe((0,u.q)(1),(0,d.U)(s=>{const i=s.find(o=>o.id===e)||null;return this._product.next(i),i}),(0,n.w)(s=>s?(0,k.of)(s):(0,L._)("Could not found product with id of "+e+"!")))}createProduct(){return this.products$.pipe((0,u.q)(1),(0,n.w)(e=>this._httpClient.post("api/apps/tesoreria/Motivos/product",{}).pipe((0,d.U)(s=>(this._products.next([s,...e]),s)))))}updateProduct(e,s){return this.products$.pipe((0,u.q)(1),(0,n.w)(i=>this._httpClient.patch("api/apps/tesoreria/Motivos/product",{id:e,product:s}).pipe((0,d.U)(o=>{const a=i.findIndex(c=>c.id===e);return i[a]=o,this._products.next(i),o}),(0,n.w)(o=>this.product$.pipe((0,u.q)(1),(0,F.h)(a=>a&&a.id===e),(0,v.b)(()=>(this._product.next(o),o)))))))}deleteProduct(e){return this.products$.pipe((0,u.q)(1),(0,n.w)(s=>this._httpClient.delete("api/apps/tesoreria/Motivos/product",{params:{id:e}}).pipe((0,d.U)(i=>{const o=s.findIndex(a=>a.id===e);return s.splice(o,1),this._products.next(s),i}))))}getTags(){return this._httpClient.get("api/apps/tesoreria/Motivos/tags").pipe((0,v.b)(e=>{this._tags.next(e)}))}createTag(e){return this.tags$.pipe((0,u.q)(1),(0,n.w)(s=>this._httpClient.post("api/apps/tesoreria/Motivos/tag",{tag:e}).pipe((0,d.U)(i=>(this._tags.next([...s,i]),i)))))}updateTag(e,s){return this.tags$.pipe((0,u.q)(1),(0,n.w)(i=>this._httpClient.patch("api/apps/tesoreria/Motivos/tag",{id:e,tag:s}).pipe((0,d.U)(o=>{const a=i.findIndex(c=>c.id===e);return i[a]=o,this._tags.next(i),o}))))}deleteTag(e){return this.tags$.pipe((0,u.q)(1),(0,n.w)(s=>this._httpClient.delete("api/apps/tesoreria/Motivos/tag",{params:{id:e}}).pipe((0,d.U)(i=>{const o=s.findIndex(a=>a.id===e);return s.splice(o,1),this._tags.next(s),i}),(0,F.h)(i=>i),(0,n.w)(i=>this.products$.pipe((0,u.q)(1),(0,d.U)(o=>(o.forEach(a=>{const c=a.tags.findIndex(f=>f===e);c>-1&&a.tags.splice(c,1)}),i)))))))}getVendors(){return this._httpClient.get("api/apps/tesoreria/Motivos/vendors").pipe((0,v.b)(e=>{this._vendors.next(e)}))}static#t=this.\u0275fac=function(s){return new(s||h)(t.LFG(B.eN))};static#e=this.\u0275prov=t.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"})}return h})();var O=r(2044),X=r(8109);const Y=[{path:"",pathMatch:"full",redirectTo:""},{path:"",component:(()=>{class h{constructor(e,s,i,o,a,c,f){this._changeDetectorRef=e,this._fuseConfirmationService=s,this._formBuilder=i,this._motivosService=o,this._financeService=a,this.router=c,this.fb=f,this.recentTransactionsDataSource=new A.by,this.recentTransactionsTableColumns=["transactionId","date","name","amount","status"],this.iconSize="icon-size-8",this.contactsCount=0,this.flashMessage=null,this.isLoading=!1,this.searchInputControl=new g.p4,this.selectedProduct=null,this.tagsEditMode=!1,this._unsubscribeAll=new w.x}ngOnInit(){this.myForm=this.fb.group({prov:["",g.kI.required],descripcion:[""],category:[""],cost:[""],vendor:[""],brand:[""],estadoprovisional:[""],generarenta:[""]}),this.selectedProductForm=this._formBuilder.group({id:[""],category:[""],name:["",[g.kI.required]],description:[""],tags:[[]],sku:[""],barcode:[""],brand:[""],vendor:[""],stock:[""],reserved:[""],cost:[""],basePrice:[""],taxPercent:[""],price:[""],weight:[""],thumbnail:[""],images:[[]],currentImageIndex:[0],active:[!1]}),this._motivosService.brands$.pipe((0,l.R)(this._unsubscribeAll)).subscribe(e=>{this.brands=e,this._changeDetectorRef.markForCheck()}),this._motivosService.categories$.pipe((0,l.R)(this._unsubscribeAll)).subscribe(e=>{this.categories=e,this._changeDetectorRef.markForCheck()}),this._motivosService.pagination$.pipe((0,l.R)(this._unsubscribeAll)).subscribe(e=>{this.pagination=e,this._changeDetectorRef.markForCheck()}),this.products$=this._motivosService.products$,this._motivosService.tags$.pipe((0,l.R)(this._unsubscribeAll)).subscribe(e=>{this.tags=e,this.filteredTags=e,this._changeDetectorRef.markForCheck()}),this._motivosService.vendors$.pipe((0,l.R)(this._unsubscribeAll)).subscribe(e=>{this.vendors=e,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,l.R)(this._unsubscribeAll),(0,U.b)(300),(0,n.w)(e=>(this.closeDetails(),this.isLoading=!0,this._motivosService.getProducts(0,10,"name","asc",e))),(0,d.U)(()=>{this.isLoading=!1})).subscribe(),this._financeService.data$.pipe((0,l.R)(this._unsubscribeAll)).subscribe(e=>{e?(this.data=e,e.recentTransactions?this.recentTransactionsDataSource.data=e.recentTransactions:console.info("La propiedad recentTransactions est\xe1 vac\xeda")):console.warn("El objeto data est\xe1 vac\xedo")})}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"name",start:"asc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,l.R)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0,this.closeDetails()}),(0,V.T)(this._sort.sortChange,this._paginator.page).pipe((0,n.w)(()=>(this.closeDetails(),this.isLoading=!0,this._motivosService.getProducts(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction))),(0,d.U)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}toggleDetails(e){this.selectedProduct&&this.selectedProduct.id===e?this.closeDetails():this._motivosService.getProductById(e).subscribe(s=>{this.selectedProduct=s,this.selectedProductForm.patchValue(s),this._changeDetectorRef.markForCheck()})}closeDetails(){this.selectedProduct=null}cycleImages(e=!0){const s=this.selectedProductForm.get("images").value.length,i=this.selectedProductForm.get("currentImageIndex").value,o=i+1===s?0:i+1,a=i-1<0?s-1:i-1;e?this.selectedProductForm.get("currentImageIndex").setValue(o):this.selectedProductForm.get("currentImageIndex").setValue(a)}toggleTagsEditMode(){this.tagsEditMode=!this.tagsEditMode}filterTags(e){const s=e.target.value.toLowerCase();this.filteredTags=this.tags.filter(i=>i.title.toLowerCase().includes(s))}filterTagsInputKeyDown(e){if("Enter"!==e.key)return;if(0===this.filteredTags.length)return this.createTag(e.target.value),void(e.target.value="");const s=this.filteredTags[0];this.selectedProduct.tags.find(o=>o===s.id)?this.removeTagFromProduct(s):this.addTagToProduct(s)}createTag(e){this._motivosService.createTag({title:e}).subscribe(i=>{this.addTagToProduct(i)})}updateTagTitle(e,s){e.title=s.target.value,this._motivosService.updateTag(e.id,e).pipe((0,U.b)(300)).subscribe(),this._changeDetectorRef.markForCheck()}deleteTag(e){this._motivosService.deleteTag(e.id).subscribe(),this._changeDetectorRef.markForCheck()}addTagToProduct(e){this.selectedProduct.tags.unshift(e.id),this.selectedProductForm.get("tags").patchValue(this.selectedProduct.tags),this._changeDetectorRef.markForCheck()}removeTagFromProduct(e){this.selectedProduct.tags.splice(this.selectedProduct.tags.findIndex(s=>s===e.id),1),this.selectedProductForm.get("tags").patchValue(this.selectedProduct.tags),this._changeDetectorRef.markForCheck()}toggleProductTag(e,s){s.checked?this.addTagToProduct(e):this.removeTagFromProduct(e)}shouldShowCreateTagButton(e){return!(""===e||this.tags.findIndex(s=>s.title.toLowerCase()===e.toLowerCase())>-1)}createProduct(){this._motivosService.createProduct().subscribe(e=>{this.selectedProduct=e,this.selectedProductForm.patchValue(e),this._changeDetectorRef.markForCheck()})}redirectToOtraVista(){this.router.navigate(["/inmobiliaria/incorporacion/detalle"])}updateSelectedProduct(){const e=this.selectedProductForm.getRawValue();delete e.currentImageIndex,this._motivosService.updateProduct(e.id,e).subscribe(()=>{this.showFlashMessage("success")})}deleteSelectedProduct(){this._fuseConfirmationService.open({title:"Delete product",message:"Are you sure you want to remove this product? This action cannot be undone!",actions:{confirm:{label:"Delete"}}}).afterClosed().subscribe(s=>{if("confirmed"===s){const i=this.selectedProductForm.getRawValue();this._motivosService.deleteProduct(i.id).subscribe(()=>{this.closeDetails()})}})}showFlashMessage(e){this.flashMessage=e,this._changeDetectorRef.markForCheck(),setTimeout(()=>{this.flashMessage=null,this._changeDetectorRef.markForCheck()},3e3)}trackByFn(e,s){return s.id||e}static#t=this.\u0275fac=function(s){return new(s||h)(t.Y36(t.sBO),t.Y36(E.R),t.Y36(g.QS),t.Y36(m),t.Y36(O.w),t.Y36(X.F0),t.Y36(g.qu))};static#e=this.\u0275cmp=t.Xpm({type:h,selectors:[["Motivos-list"]],viewQuery:function(s,i){if(1&s&&(t.Gf(Z.NW,5),t.Gf(P.YE,5)),2&s){let o;t.iGM(o=t.CRH())&&(i._paginator=o.first),t.iGM(o=t.CRH())&&(i._sort=o.first)}},standalone:!0,features:[t.jDz],decls:74,vars:0,consts:[[1,"sm:absolute","sm:inset-0","flex","flex-col","flex-auto","min-w-0","sm:overflow-hidden","bg-card","dark:bg-transparent"],[1,"flex","flex-col","sm:flex-row","md:flex-col","flex-auto","justify-between","py-8","px-6","md:px-8","border-b"],[1,"container","overflow-y-auto",2,"max-height","400px"],[1,"overflow-y-auto","max-h-[400px]"],[1,"container","mx-auto"],[1,"flex","items-center","mb-4"],[1,"text-lg","font-semibold"],[1,"flex","space-x-4"],["mat-raised-button","","color","primary",1,"flex","items-center"],["mat-raised-button","","color","warn",1,"flex","items-center"],[1,"overflow-x-auto"],[1,"w-full","border-collapse","border","border-gray-300"],[1,"border","border-gray-300","px-4","py-2"],["mat-raised-button","","color","primary"]],template:function(s,i){1&s&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"h2",6),t._uU(7,"Dep\xf3sitos"),t.qZA()(),t.TgZ(8,"div",5),t._UZ(9,"div"),t.TgZ(10,"div",7)(11,"button",8)(12,"mat-icon"),t._uU(13,"add"),t.qZA(),t.TgZ(14,"span"),t._uU(15,"Agregar"),t.qZA()(),t.TgZ(16,"button",9)(17,"mat-icon"),t._uU(18,"delete"),t.qZA(),t.TgZ(19,"span"),t._uU(20,"Editar"),t.qZA()(),t.TgZ(21,"button",9)(22,"mat-icon"),t._uU(23,"delete"),t.qZA(),t.TgZ(24,"span"),t._uU(25,"Activar/desactivar"),t.qZA()()()(),t.TgZ(26,"div",10)(27,"table",11)(28,"thead")(29,"tr")(30,"th",12),t._uU(31,"Motivo"),t.qZA(),t.TgZ(32,"th",12),t._uU(33,"Tipo"),t.qZA(),t.TgZ(34,"th",12),t._uU(35,"CC. Cuentas por Cobrar"),t.qZA(),t.TgZ(36,"th",12),t._uU(37,"CC. Ventas"),t.qZA(),t.TgZ(38,"th",12),t._uU(39,"CC. Ventas IGV"),t.qZA(),t.TgZ(40,"th",12),t._uU(41,"CC. Rem. Transito"),t.qZA(),t.TgZ(42,"th",12),t._uU(43,"CC. Rem. Trans. Detrac."),t.qZA(),t.TgZ(44,"th",12),t._uU(45,"Estado"),t.qZA(),t.TgZ(46,"th",12),t._uU(47,"Cod."),t.qZA()()(),t.TgZ(48,"tbody")(49,"tr")(50,"td",12),t._uU(51,"Motivo"),t.qZA(),t.TgZ(52,"td",12),t._uU(53,"Tipo"),t.qZA(),t.TgZ(54,"td",12),t._uU(55,"CC. Cuentas por Cobrar"),t.qZA(),t.TgZ(56,"td",12),t._uU(57,"CC. Ventas"),t.qZA(),t.TgZ(58,"td",12),t._uU(59,"CC. Ventas IGV"),t.qZA(),t.TgZ(60,"td",12),t._uU(61,"CC. Rem. Transito"),t.qZA(),t.TgZ(62,"td",12),t._uU(63,"CC. Rem. Trans. Detrac."),t.qZA(),t.TgZ(64,"td",12),t._uU(65,"Estado"),t.qZA(),t.TgZ(66,"td",12),t._uU(67,"Cod."),t.qZA()()()()()()(),t.TgZ(68,"h2"),t._uU(69,"Pagos de arrendamiento"),t.qZA(),t.TgZ(70,"p"),t._uU(71,"Este es el contenido de la primera pesta\xf1a."),t.qZA(),t.TgZ(72,"button",13),t._uU(73,"Bot\xf3n de la pesta\xf1a 1"),t.qZA()()()())},dependencies:[R.Cv,I.lN,C.Ps,C.Hw,D.c,g.u5,g.UX,T.ot,T.lW,P.JX,Z.TU,S.rP,y.LD,x.Ng,M.p9,x.si,A.p0],styles:[".Motivos-grid{grid-template-columns:48px auto 40px}@media (min-width: 600px){.Motivos-grid{grid-template-columns:48px auto 112px 72px}}@media (min-width: 960px){.Motivos-grid{grid-template-columns:48px 112px auto 112px 72px}}@media (min-width: 1280px){.Motivos-grid{grid-template-columns:48px 112px auto 112px 96px 96px 72px}}\n"],encapsulation:2,data:{animation:$.L},changeDetection:0})}return h})(),resolve:{brands:()=>(0,t.f3M)(m).getBrands(),categories:()=>(0,t.f3M)(m).getCategories(),products:()=>(0,t.f3M)(m).getProducts(),tags:()=>(0,t.f3M)(m).getTags(),vendors:()=>(0,t.f3M)(m).getVendors()}}]}}]);